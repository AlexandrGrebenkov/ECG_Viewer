using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ECG_Viewer
{
    class Filtr
    {
        int last_index = new int();

        double[] history;
        double[] filter_taps_cffs;

        const int DefaultFilterTapNum = 169;

        public const int FILTR_30_HZ = 0x00;
        public const int FILTR_50_HZ = 0x01;
        public const int FILTR_80_HZ = 0x02;
        public const int FILTR_100_150_HZ = 0x03;
        public const int FILTR_Over100HZ = 0x04;

        static double[] filter_taps_Over100Hz = {
          0.0001931559321712459,
          -0.0008916652860136387,
          -0.0011465259650815505,
          -0.0005984460078691479,
          0.00027532338037803214,
          0.0003839441739407677,
          -0.0002244700787089475,
          -0.0004186160042244629,
          0.00015521957388504504,
          0.00048014061179107786,
          -0.000059784901379620347,
          -0.0005388963896391684,
          -0.00006600188294794385,
          0.0005762857060097587,
          0.0002181535708916992,
          -0.0005790424198422614,
          -0.0003886374429750059,
          0.0005370308142196904,
          0.0005658885100404444,
          -0.000443525609660639,
          -0.0007358185599706658,
          0.0002957320751919158,
          0.0008824711140232081,
          -0.00009527096687825797,
          -0.000989236920673702,
          -0.00015150351852938438,
          0.0010400558028934325,
          0.0004333399533147719,
          -0.0010208229302989256,
          -0.0007341391590904298,
          0.0009209224909648103,
          0.001033818430858467,
          -0.0007341177833824993,
          -0.0013089871757487558,
          0.00046023614285796145,
          0.001534991322086684,
          -0.00010558800344373959,
          -0.0016865364582126121,
          -0.0003158639179068171,
          0.0017408999719662113,
          0.0007849053982790651,
          -0.0016770020743725384,
          -0.0012710106536715183,
          0.001485444420803855,
          0.0017473429946890061,
          -0.0011546127285980408,
          -0.0021724001961340163,
          0.0006908094403113657,
          0.0025094422606930554,
          -0.00010773210238753457,
          -0.002722741216744156,
          -0.0005721234608638264,
          0.0027786344978179413,
          0.0013156317071103159,
          -0.0026495006694927377,
          -0.0020797578718793706,
          0.0023171098451643126,
          0.0028143350754709566,
          -0.0017751293793915966,
          -0.003464205899459961,
          0.0010304495110303828,
          0.003972638259645912,
          -0.00010472492667800736,
          -0.004284548890197913,
          -0.000965385972339835,
          0.004350489025410484,
          0.0021289146811897383,
          -0.004130361697940317,
          -0.003321857741688942,
          0.0035966694168627017,
          0.004469134303311587,
          -0.002738442748991138,
          -0.005488607458780491,
          0.0015631249378066816,
          0.006294063005774494,
          -0.00009923816347498214,
          -0.006800572375232141,
          -0.0016036301267196226,
          0.006928464110841331,
          0.003474000275403817,
          -0.00660932851296509,
          -0.005421475375280212,
          0.005788691292870259,
          0.007336021222868385,
          -0.004433297818333252,
          -0.00909527354944174,
          0.0025302605659220366,
          0.010563978231932683,
          -0.00009250106729663634,
          -0.011599935048099114,
          -0.00284113640503301,
          0.01205724933978043,
          0.00620687750247608,
          -0.01178670858697552,
          -0.009917892216910362,
          0.01063575024237352,
          0.01386474839176329,
          -0.008439620478425882,
          -0.017923693337639466,
          0.00500898509785435,
          0.021957655519731,
          -0.00008814737114545865,
          -0.025825156329843856,
          -0.006725529160420759,
          0.029385967141726154,
          0.0161767185935861,
          -0.032507367473563344,
          -0.029886210627491836,
          0.03507079236874426,
          0.05216354422957259,
          -0.03697667172459486,
          -0.0990546819605048,
          0.0381510797394343,
          0.315935120537228,
          0.4614523338545856,
          0.315935120537228,
          0.0381510797394343,
          -0.0990546819605048,
          -0.03697667172459486,
          0.05216354422957259,
          0.03507079236874426,
          -0.029886210627491836,
          -0.032507367473563344,
          0.0161767185935861,
          0.029385967141726154,
          -0.006725529160420759,
          -0.025825156329843856,
          -0.00008814737114545865,
          0.021957655519731,
          0.00500898509785435,
          -0.017923693337639466,
          -0.008439620478425882,
          0.01386474839176329,
          0.01063575024237352,
          -0.009917892216910362,
          -0.01178670858697552,
          0.00620687750247608,
          0.01205724933978043,
          -0.00284113640503301,
          -0.011599935048099114,
          -0.00009250106729663634,
          0.010563978231932683,
          0.0025302605659220366,
          -0.00909527354944174,
          -0.004433297818333252,
          0.007336021222868385,
          0.005788691292870259,
          -0.005421475375280212,
          -0.00660932851296509,
          0.003474000275403817,
          0.006928464110841331,
          -0.0016036301267196226,
          -0.006800572375232141,
          -0.00009923816347498214,
          0.006294063005774494,
          0.0015631249378066816,
          -0.005488607458780491,
          -0.002738442748991138,
          0.004469134303311587,
          0.0035966694168627017,
          -0.003321857741688942,
          -0.004130361697940317,
          0.0021289146811897383,
          0.004350489025410484,
          -0.000965385972339835,
          -0.004284548890197913,
          -0.00010472492667800736,
          0.003972638259645912,
          0.0010304495110303828,
          -0.003464205899459961,
          -0.0017751293793915966,
          0.0028143350754709566,
          0.0023171098451643126,
          -0.0020797578718793706,
          -0.0026495006694927377,
          0.0013156317071103159,
          0.0027786344978179413,
          -0.0005721234608638264,
          -0.002722741216744156,
          -0.00010773210238753457,
          0.0025094422606930554,
          0.0006908094403113657,
          -0.0021724001961340163,
          -0.0011546127285980408,
          0.0017473429946890061,
          0.001485444420803855,
          -0.0012710106536715183,
          -0.0016770020743725384,
          0.0007849053982790651,
          0.0017408999719662113,
          -0.0003158639179068171,
          -0.0016865364582126121,
          -0.00010558800344373959,
          0.001534991322086684,
          0.00046023614285796145,
          -0.0013089871757487558,
          -0.0007341177833824993,
          0.001033818430858467,
          0.0009209224909648103,
          -0.0007341391590904298,
          -0.0010208229302989256,
          0.0004333399533147719,
          0.0010400558028934325,
          -0.00015150351852938438,
          -0.000989236920673702,
          -0.00009527096687825797,
          0.0008824711140232081,
          0.0002957320751919158,
          -0.0007358185599706658,
          -0.000443525609660639,
          0.0005658885100404444,
          0.0005370308142196904,
          -0.0003886374429750059,
          -0.0005790424198422614,
          0.0002181535708916992,
          0.0005762857060097587,
          -0.00006600188294794385,
          -0.0005388963896391684,
          -0.000059784901379620347,
          0.00048014061179107786,
          0.00015521957388504504,
          -0.0004186160042244629,
          -0.0002244700787089475,
          0.0003839441739407677,
          0.00027532338037803214,
          -0.0005984460078691479,
          -0.0011465259650815505,
          -0.0008916652860136387,
          0.0001931559321712459
        };


        static double[] filter_taps_100_150_HZ = 
        {
          0.00006345203190555917,
          -0.0006836676590010583,
          -0.00017135744813520906,
          -0.00030843384210453415,
          0.00013298989229291677,
          0.00009096860722709608,
          0.00027279184062307455,
          -0.0005040418123352917,
          -0.00039066749256292077,
          0.0012572063545981558,
          -0.00042143164621165417,
          -0.0008661552580679002,
          0.0005448879731241931,
          0.00007420610288952833,
          0.00087124961311719,
          -0.0012398838463672963,
          -0.0010235414097824413,
          0.002737070251791314,
          -0.0008642116630671545,
          -0.0014678771334717805,
          0.0009114883815234482,
          -0.00004303103898247489,
          0.0012174393532801606,
          -0.0013799999491051517,
          -0.0011383117242108037,
          0.0024853321318136674,
          -0.0007062982476003401,
          -0.0008588764809640435,
          0.0004932819447518385,
          -0.00020285828065443395,
          0.00032916612902909057,
          0.00012991747563412284,
          0.00012395362030814767,
          -0.0013048064602008303,
          0.0005856481463833801,
          0.0014904295526361555,
          -0.0010488037058757253,
          -0.0002394706140764459,
          -0.0018295807918077675,
          0.0029667961392835693,
          0.002409070496085755,
          -0.0071008896943837475,
          0.0024249189449720224,
          0.0041871177374126845,
          -0.0027659749226934312,
          -0.00004438356290424917,
          -0.0036110587037974195,
          0.0047180365944619876,
          0.0036899853645036554,
          -0.009319218573380576,
          0.0029383550172939147,
          0.004180932667024028,
          -0.00261338339519471,
          0.00027209698539377677,
          -0.0025142388180161264,
          0.0023544060374620086,
          0.001614096965956328,
          -0.002317573875022929,
          0.0003276504826779025,
          -0.00069780711937206,
          0.0008253044654189621,
          0.0004249506623788821,
          0.002334490599969654,
          -0.0045770806298866895,
          -0.0038858747292257268,
          0.012852552464510359,
          -0.0048434069518298204,
          -0.008550932695458447,
          0.006127738367789252,
          0.00021640641127360267,
          0.008085690149440829,
          -0.01162961998488895,
          -0.00899800555451812,
          0.024989787027817772,
          -0.008550763697454968,
          -0.01273746426794979,
          0.008570179655604254,
          -0.00023561292717147624,
          0.00888134107806201,
          -0.010913774577142469,
          -0.007634227854097339,
          0.017823740298494695,
          -0.005199522563119429,
          -0.005547899813523631,
          0.0027966119471723844,
          -0.0005494393100587866,
          -0.00020596479303098278,
          0.003459307830044289,
          0.004113796232566096,
          -0.01783222906120416,
          0.008111839820367634,
          0.0155807989206808,
          -0.012759378039677858,
          -0.0004142962932282505,
          -0.018598410271148776,
          0.02968690230960481,
          0.023907303215808307,
          -0.07381199201801637,
          0.02808913447898949,
          0.04418346014098281,
          -0.033147913265725304,
          0.00009363547454791162,
          -0.03899828090189256,
          0.05724461947417036,
          0.04318931612305077,
          -0.12571682735805256,
          0.0458562182211249,
          0.06712218881848388,
          -0.04877194088035528,
          0.0005465901772802681,
          -0.0512294832284738,
          0.0724372243886885,
          0.05208264214630797,
          0.8531441117012746,
          0.05208264214630797,
          0.0724372243886885,
          -0.0512294832284738,
          0.0005465901772802681,
          -0.04877194088035528,
          0.06712218881848388,
          0.0458562182211249,
          -0.12571682735805256,
          0.04318931612305077,
          0.05724461947417036,
          -0.03899828090189256,
          0.00009363547454791162,
          -0.033147913265725304,
          0.04418346014098281,
          0.02808913447898949,
          -0.07381199201801637,
          0.023907303215808307,
          0.02968690230960481,
          -0.018598410271148776,
          -0.0004142962932282505,
          -0.012759378039677858,
          0.0155807989206808,
          0.008111839820367634,
          -0.01783222906120416,
          0.004113796232566096,
          0.003459307830044289,
          -0.00020596479303098278,
          -0.0005494393100587866,
          0.0027966119471723844,
          -0.005547899813523631,
          -0.005199522563119429,
          0.017823740298494695,
          -0.007634227854097339,
          -0.010913774577142469,
          0.00888134107806201,
          -0.00023561292717147624,
          0.008570179655604254,
          -0.01273746426794979,
          -0.008550763697454968,
          0.024989787027817772,
          -0.00899800555451812,
          -0.01162961998488895,
          0.008085690149440829,
          0.00021640641127360267,
          0.006127738367789252,
          -0.008550932695458447,
          -0.0048434069518298204,
          0.012852552464510359,
          -0.0038858747292257268,
          -0.0045770806298866895,
          0.002334490599969654,
          0.0004249506623788821,
          0.0008253044654189621,
          -0.00069780711937206,
          0.0003276504826779025,
          -0.002317573875022929,
          0.001614096965956328,
          0.0023544060374620086,
          -0.0025142388180161264,
          0.00027209698539377677,
          -0.00261338339519471,
          0.004180932667024028,
          0.0029383550172939147,
          -0.009319218573380576,
          0.0036899853645036554,
          0.0047180365944619876,
          -0.0036110587037974195,
          -0.00004438356290424917,
          -0.0027659749226934312,
          0.0041871177374126845,
          0.0024249189449720224,
          -0.0071008896943837475,
          0.002409070496085755,
          0.0029667961392835693,
          -0.0018295807918077675,
          -0.0002394706140764459,
          -0.0010488037058757253,
          0.0014904295526361555,
          0.0005856481463833801,
          -0.0013048064602008303,
          0.00012395362030814767,
          0.00012991747563412284,
          0.00032916612902909057,
          -0.00020285828065443395,
          0.0004932819447518385,
          -0.0008588764809640435,
          -0.0007062982476003401,
          0.0024853321318136674,
          -0.0011383117242108037,
          -0.0013799999491051517,
          0.0012174393532801606,
          -0.00004303103898247489,
          0.0009114883815234482,
          -0.0014678771334717805,
          -0.0008642116630671545,
          0.002737070251791314,
          -0.0010235414097824413,
          -0.0012398838463672963,
          0.00087124961311719,
          0.00007420610288952833,
          0.0005448879731241931,
          -0.0008661552580679002,
          -0.00042143164621165417,
          0.0012572063545981558,
          -0.00039066749256292077,
          -0.0005040418123352917,
          0.00027279184062307455,
          0.00009096860722709608,
          0.00013298989229291677,
          -0.00030843384210453415,
          -0.00017135744813520906,
          -0.0006836676590010583,
          0.00006345203190555917
        };

        
        static double[] filter_taps_30_Hz = 
        {         
          0.001306817425039845,
          -0.0007795522116000069,
          -0.0002191295066921646,
          -0.00011539045824137822,
          -0.0005134256355243653,
          -0.0010828338483103246,
          -0.0013818739441666774,
          -0.0011636734138452205,
          -0.0005061079895598817,
          0.00028759611174308445,
          0.0009037859212227524,
          0.0011836915810644279,
          0.0011479090705907241,
          0.0009081457375123653,
          0.0005625900356695862,
          0.00015645185933158448,
          -0.000284120605295651,
          -0.0006999383372864954,
          -0.0009879180726506025,
          -0.001045937720076966,
          -0.0008398261959167536,
          -0.0004408299427218632,
          -8.068958859393943e-7,
          0.0003193433862056851,
          0.0004247033354224036,
          0.0003248199296413472,
          0.00011922343905998818,
          -0.00005634290012021327,
          -0.00008935793806341576,
          0.00006631377739380433,
          0.0003757087206691081,
          0.000737800114083988,
          0.001013577615214958,
          0.0010687676723403045,
          0.0008141746850706839,
          0.0002430385568005073,
          -0.0005514831081145131,
          -0.001385335764920071,
          -0.0020263981506334536,
          -0.002261252619835452,
          -0.0019662878774192464,
          -0.0011580462929190348,
          -0.0000017918548035545188,
          0.0012273848427462534,
          0.0022198097677828092,
          0.002719653375663799,
          0.0025991595031264678,
          0.001895743723197323,
          0.0008013657192830786,
          -0.0003928070081069298,
          -0.0013818302364018266,
          -0.0019350416697850596,
          -0.0019620433357781927,
          -0.0015335965373183586,
          -0.0008522510486178737,
          -0.00017964216430239126,
          0.00025406776138468454,
          0.00033100189750394235,
          0.0000873275440138912,
          -0.00030005638661785913,
          -0.0005783912007033339,
          -0.0005165371446326021,
          -2.5236351955493414e-7,
          0.0009078078577712463,
          0.0019673600845440194,
          0.002822484848106307,
          0.003112384241676613,
          0.002595800616248286,
          0.0012501864697981972,
          -0.0006905486120966913,
          -0.0027781235262791604,
          -0.004463853610960823,
          -0.005253483850165646,
          -0.004857718701025144,
          -0.0032916928833637282,
          -0.0008894944293771756,
          0.0017751030137363323,
          0.004043147482673723,
          0.005355881369602934,
          0.005413155684523455,
          0.00425860695319708,
          0.002260070688276563,
          -0.0000016340161074340502,
          -0.0019158422348500204,
          -0.0030216669057424104,
          -0.003149335260169308,
          -0.002455892035264366,
          -0.0013565965000015424,
          -0.00037121572882893507,
          0.00006949625486545064,
          -0.00021464965464805153,
          -0.0010763611060094875,
          -0.002078429759667467,
          -0.002644461876487995,
          -0.0022740292821719385,
          -0.0007460898073380871,
          0.001755380230444046,
          0.004641487043859141,
          0.007059736889785068,
          0.008144329963628585,
          0.007299347585002234,
          0.004422960393626434,
          -0.0000016859194909515884,
          -0.004986255895186166,
          -0.009279712277592646,
          -0.01171511590948244,
          -0.011552769370808303,
          -0.008710640703130167,
          -0.003819331787945662,
          0.0019247100397328971,
          0.007092928136319774,
          0.01042916111720698,
          0.011189524690912576,
          0.0093777610490937,
          0.005702654017061646,
          0.0013636341764381068,
          -0.0023466706314862365,
          -0.004452576737305918,
          -0.004608677837471092,
          -0.003202014997051796,
          -0.0012047696253754663,
          0.0001847385211532997,
          -4.718984820538511e-8,
          -0.00208967295772335,
          -0.00557089841774269,
          -0.009165376591637254,
          -0.011196400589107676,
          -0.010148838921166636,
          -0.005254858614115904,
          0.0030869498910490786,
          0.013218380501244454,
          0.022525145844546186,
          0.028088792515586925,
          0.027529177264891225,
          0.019801046021743457,
          0.005700237128001308,
          -0.012102539405194542,
          -0.02956062330692689,
          -0.042194638491982274,
          -0.04625305482539459,
          -0.03978711921594682,
          -0.02333531563439183,
          0.0000019839012852365438,
          0.0251577970534944,
          0.04625215436271531,
          0.058025986257101626,
          0.057195787686190463,
          0.043367551545869715,
          0.01925672964841805,
          -0.009870302067026278,
          -0.03741201231037753,
          -0.057010156679415676,
          0.9359041128473384,
          -0.057010156679415676,
          -0.03741201231037753,
          -0.009870302067026278,
          0.01925672964841805,
          0.043367551545869715,
          0.057195787686190463,
          0.058025986257101626,
          0.04625215436271531,
          0.0251577970534944,
          0.0000019839012852365438,
          -0.02333531563439183,
          -0.03978711921594682,
          -0.04625305482539459,
          -0.042194638491982274,
          -0.02956062330692689,
          -0.012102539405194542,
          0.005700237128001308,
          0.019801046021743457,
          0.027529177264891225,
          0.028088792515586925,
          0.022525145844546186,
          0.013218380501244454,
          0.0030869498910490786,
          -0.005254858614115904,
          -0.010148838921166636,
          -0.011196400589107676,
          -0.009165376591637254,
          -0.00557089841774269,
          -0.00208967295772335,
          -4.718984820538511e-8,
          0.0001847385211532997,
          -0.0012047696253754663,
          -0.003202014997051796,
          -0.004608677837471092,
          -0.004452576737305918,
          -0.0023466706314862365,
          0.0013636341764381068,
          0.005702654017061646,
          0.0093777610490937,
          0.011189524690912576,
          0.01042916111720698,
          0.007092928136319774,
          0.0019247100397328971,
          -0.003819331787945662,
          -0.008710640703130167,
          -0.011552769370808303,
          -0.01171511590948244,
          -0.009279712277592646,
          -0.004986255895186166,
          -0.0000016859194909515884,
          0.004422960393626434,
          0.007299347585002234,
          0.008144329963628585,
          0.007059736889785068,
          0.004641487043859141,
          0.001755380230444046,
          -0.0007460898073380871,
          -0.0022740292821719385,
          -0.002644461876487995,
          -0.002078429759667467,
          -0.0010763611060094875,
          -0.00021464965464805153,
          0.00006949625486545064,
          -0.00037121572882893507,
          -0.0013565965000015424,
          -0.002455892035264366,
          -0.003149335260169308,
          -0.0030216669057424104,
          -0.0019158422348500204,
          -0.0000016340161074340502,
          0.002260070688276563,
          0.00425860695319708,
          0.005413155684523455,
          0.005355881369602934,
          0.004043147482673723,
          0.0017751030137363323,
          -0.0008894944293771756,
          -0.0032916928833637282,
          -0.004857718701025144,
          -0.005253483850165646,
          -0.004463853610960823,
          -0.0027781235262791604,
          -0.0006905486120966913,
          0.0012501864697981972,
          0.002595800616248286,
          0.003112384241676613,
          0.002822484848106307,
          0.0019673600845440194,
          0.0009078078577712463,
          -2.5236351955493414e-7,
          -0.0005165371446326021,
          -0.0005783912007033339,
          -0.00030005638661785913,
          0.0000873275440138912,
          0.00033100189750394235,
          0.00025406776138468454,
          -0.00017964216430239126,
          -0.0008522510486178737,
          -0.0015335965373183586,
          -0.0019620433357781927,
          -0.0019350416697850596,
          -0.0013818302364018266,
          -0.0003928070081069298,
          0.0008013657192830786,
          0.001895743723197323,
          0.0025991595031264678,
          0.002719653375663799,
          0.0022198097677828092,
          0.0012273848427462534,
          -0.0000017918548035545188,
          -0.0011580462929190348,
          -0.0019662878774192464,
          -0.002261252619835452,
          -0.0020263981506334536,
          -0.001385335764920071,
          -0.0005514831081145131,
          0.0002430385568005073,
          0.0008141746850706839,
          0.0010687676723403045,
          0.001013577615214958,
          0.000737800114083988,
          0.0003757087206691081,
          0.00006631377739380433,
          -0.00008935793806341576,
          -0.00005634290012021327,
          0.00011922343905998818,
          0.0003248199296413472,
          0.0004247033354224036,
          0.0003193433862056851,
          -8.068958859393943e-7,
          -0.0004408299427218632,
          -0.0008398261959167536,
          -0.001045937720076966,
          -0.0009879180726506025,
          -0.0006999383372864954,
          -0.000284120605295651,
          0.00015645185933158448,
          0.0005625900356695862,
          0.0009081457375123653,
          0.0011479090705907241,
          0.0011836915810644279,
          0.0009037859212227524,
          0.00028759611174308445,
          -0.0005061079895598817,
          -0.0011636734138452205,
          -0.0013818739441666774,
          -0.0010828338483103246,
          -0.0005134256355243653,
          -0.00011539045824137822,
          -0.0002191295066921646,
          -0.0007795522116000069,
          0.001306817425039845
        };


        static double[] filter_taps_50_Hz = {
            0.00017053182021043673,
            0.002375503285843193,
            0.00046267469149731774,
            0.000007109570858166837,
            -0.0006729528797468857,
            -0.0010047581938884547,
            -0.0007438781223283333,
            0.0000018530544985072558,
            0.0007986574576079452,
            0.0011503013962766275,
            0.0008205420289797135,
            -0.000001826440848672057,
            -0.0008147813778409221,
            -0.0011253161810474168,
            -0.0007671190224852113,
            0.0000013515834960161387,
            0.0006834842588656694,
            0.0008829684391093761,
            0.0005551962880048575,
            -4.99129706743818e-7,
            -0.0003883348219744304,
            -0.0004100234699586218,
            -0.00018294217255260945,
            -5.093019812752566e-7,
            -0.000056340633293012926,
            -0.0002619324522164867,
            -0.0003192066479945142,
            0.000001572277134480582,
            0.000602060612633818,
            0.0010522326537415983,
            0.0008855477830443903,
            -0.0000023200865147690644,
            -0.0011679211521933512,
            -0.0018367581825961025,
            -0.0014223433387579771,
            0.00000285417755732254,
            0.0016497935538188568,
            0.002463558643048614,
            0.001820078492885045,
            -0.0000032079566037756224,
            -0.0019371929509831034,
            -0.0027780285568738405,
            -0.001971863932277525,
            0.0000030520041899633585,
            0.0019320852267699208,
            0.0026512556574539593,
            0.0017946645045240981,
            -0.0000026088217802963617,
            -0.001572319350174708,
            -0.0020124608608626774,
            -0.0012518138037889163,
            0.0000017901007328706043,
            0.0008506159999136579,
            0.0008743137088969924,
            0.00036893043996775207,
            -5.618956180899106e-7,
            0.00017306493846705435,
            0.0006536824269606679,
            0.0007595501308510774,
            -8.742307748000707e-7,
            -0.0013695288905366792,
            -0.0023670364665738896,
            -0.0019735047972474,
            0.000001873071424909527,
            0.0025517605573395176,
            0.003984951338383105,
            0.00306516096973084,
            -0.000002719204925658536,
            -0.003498196624649257,
            -0.005189249935462756,
            -0.0038084153236472517,
            0.000003032471788315575,
            0.003987243927395895,
            0.0056754892975286915,
            0.003996670185604576,
            -0.0000027147999888166446,
            -0.003836942174971504,
            -0.005209432338592681,
            -0.0034828218336557483,
            0.0000021555941557190194,
            0.002946598914724659,
            0.003682935264310594,
            0.002219961836527404,
            -0.000002322129287542743,
            -0.0013244390678368897,
            -0.0011584077682445665,
            -0.00028066655776356206,
            5.687658153950554e-7,
            -0.0008830080099738821,
            -0.0021179313823854753,
            -0.0021250712431940323,
            0.0000019184073448559608,
            0.003405108994954024,
            0.005714070661818538,
            0.004664980397756738,
            -0.000002515453148897668,
            -0.005859057706527145,
            -0.009060628335325284,
            -0.0069143267904824375,
            0.0000036386979758905475,
            0.007791083312273548,
            0.011505969639562713,
            0.0084126376161289,
            -0.0000032106589717460454,
            -0.008743398929852401,
            -0.012411520172963585,
            -0.008716496944847945,
            0.0000029578426262213192,
            0.008309358243705113,
            0.01123717236587764,
            0.007474743850770144,
            -0.000002432121287213087,
            -0.006208177523377202,
            -0.007642387255925362,
            -0.0044888104195036395,
            8.369067503893489e-7,
            0.002331908898329567,
            0.0015453203411443248,
            -0.00024825316012127283,
            -6.969708280286631e-7,
            0.0032140759611271976,
            0.00682868543896485,
            0.006520444725132137,
            -0.0000013121840728788887,
            -0.010109913716510047,
            -0.016951248303323715,
            -0.013904970497573185,
            0.000003447704132662037,
            0.017838715169858053,
            0.028034088455767683,
            0.02180743379771552,
            -0.0000037566085867917596,
            -0.02573927235085496,
            -0.039108179455329684,
            -0.029521987149615948,
            0.0000034429268586007466,
            0.03308196758996963,
            0.04913444021001729,
            0.03631373165041191,
            -0.0000030768916882240373,
            -0.03915334507402605,
            -0.057127418094973716,
            -0.04151070271338355,
            0.0000026379541617355584,
            0.04334160775240491,
            0.06227878174803335,
            0.04458422163756594,
            -0.000001014475667494281,
            -0.045216576510921494,
            0.9359425289424319,
            -0.045216576510921494,
            -0.000001014475667494281,
            0.04458422163756594,
            0.06227878174803335,
            0.04334160775240491,
            0.0000026379541617355584,
            -0.04151070271338355,
            -0.057127418094973716,
            -0.03915334507402605,
            -0.0000030768916882240373,
            0.03631373165041191,
            0.04913444021001729,
            0.03308196758996963,
            0.0000034429268586007466,
            -0.029521987149615948,
            -0.039108179455329684,
            -0.02573927235085496,
            -0.0000037566085867917596,
            0.02180743379771552,
            0.028034088455767683,
            0.017838715169858053,
            0.000003447704132662037,
            -0.013904970497573185,
            -0.016951248303323715,
            -0.010109913716510047,
            -0.0000013121840728788887,
            0.006520444725132137,
            0.00682868543896485,
            0.0032140759611271976,
            -6.969708280286631e-7,
            -0.00024825316012127283,
            0.0015453203411443248,
            0.002331908898329567,
            8.369067503893489e-7,
            -0.0044888104195036395,
            -0.007642387255925362,
            -0.006208177523377202,
            -0.000002432121287213087,
            0.007474743850770144,
            0.01123717236587764,
            0.008309358243705113,
            0.0000029578426262213192,
            -0.008716496944847945,
            -0.012411520172963585,
            -0.008743398929852401,
            -0.0000032106589717460454,
            0.0084126376161289,
            0.011505969639562713,
            0.007791083312273548,
            0.0000036386979758905475,
            -0.0069143267904824375,
            -0.009060628335325284,
            -0.005859057706527145,
            -0.000002515453148897668,
            0.004664980397756738,
            0.005714070661818538,
            0.003405108994954024,
            0.0000019184073448559608,
            -0.0021250712431940323,
            -0.0021179313823854753,
            -0.0008830080099738821,
            5.687658153950554e-7,
            -0.00028066655776356206,
            -0.0011584077682445665,
            -0.0013244390678368897,
            -0.000002322129287542743,
            0.002219961836527404,
            0.003682935264310594,
            0.002946598914724659,
            0.0000021555941557190194,
            -0.0034828218336557483,
            -0.005209432338592681,
            -0.003836942174971504,
            -0.0000027147999888166446,
            0.003996670185604576,
            0.0056754892975286915,
            0.003987243927395895,
            0.000003032471788315575,
            -0.0038084153236472517,
            -0.005189249935462756,
            -0.003498196624649257,
            -0.000002719204925658536,
            0.00306516096973084,
            0.003984951338383105,
            0.0025517605573395176,
            0.000001873071424909527,
            -0.0019735047972474,
            -0.0023670364665738896,
            -0.0013695288905366792,
            -8.742307748000707e-7,
            0.0007595501308510774,
            0.0006536824269606679,
            0.00017306493846705435,
            -5.618956180899106e-7,
            0.00036893043996775207,
            0.0008743137088969924,
            0.0008506159999136579,
            0.0000017901007328706043,
            -0.0012518138037889163,
            -0.0020124608608626774,
            -0.001572319350174708,
            -0.0000026088217802963617,
            0.0017946645045240981,
            0.0026512556574539593,
            0.0019320852267699208,
            0.0000030520041899633585,
            -0.001971863932277525,
            -0.0027780285568738405,
            -0.0019371929509831034,
            -0.0000032079566037756224,
            0.001820078492885045,
            0.002463558643048614,
            0.0016497935538188568,
            0.00000285417755732254,
            -0.0014223433387579771,
            -0.0018367581825961025,
            -0.0011679211521933512,
            -0.0000023200865147690644,
            0.0008855477830443903,
            0.0010522326537415983,
            0.000602060612633818,
            0.000001572277134480582,
            -0.0003192066479945142,
            -0.0002619324522164867,
            -0.000056340633293012926,
            -5.093019812752566e-7,
            -0.00018294217255260945,
            -0.0004100234699586218,
            -0.0003883348219744304,
            -4.99129706743818e-7,
            0.0005551962880048575,
            0.0008829684391093761,
            0.0006834842588656694,
            0.0000013515834960161387,
            -0.0007671190224852113,
            -0.0011253161810474168,
            -0.0008147813778409221,
            -0.000001826440848672057,
            0.0008205420289797135,
            0.0011503013962766275,
            0.0007986574576079452,
            0.0000018530544985072558,
            -0.0007438781223283333,
            -0.0010047581938884547,
            -0.0006729528797468857,
            0.000007109570858166837,
            0.00046267469149731774,
            0.002375503285843193,
            0.00017053182021043673
        };


        static double[] filter_taps_80_Hz = {
          -0.0002011960648318946,
          -0.0004842772922243099,
          -0.0008673275936080969,
          0.0020169473933935368,
          0.0010293459744620391,
          -0.000013328020676656547,
          -0.0007445411631120293,
          -0.0001700693475991525,
          0.001020242692458911,
          0.0010213952937008289,
          -0.0003070458298276321,
          -0.0011678147530398077,
          -0.00034548491139676997,
          0.0010150372170075522,
          0.0009980609752710539,
          -0.0003554634849200615,
          -0.0011399029233798868,
          -0.0003318534003213595,
          0.0008350442496565084,
          0.0007663498483395823,
          -0.0002591300823015407,
          -0.0007316298104571772,
          -0.0001868015242917632,
          0.0003774187169437443,
          0.0002544678091375251,
          -0.00004504895517187435,
          0.000026864625956359102,
          0.00006522520619818877,
          -0.00032683771909700716,
          -0.0004848391948224378,
          0.00024941007312889344,
          0.001006192947844117,
          0.0003742278993398604,
          -0.0011430667918108715,
          -0.0012990767112802,
          0.0005555640816802097,
          0.0019740320630410287,
          0.0006601600806405553,
          -0.0018535023971321522,
          -0.0019615233354878937,
          0.0007850510826642776,
          0.002630755983376361,
          0.0008333473706077061,
          -0.002216448919796824,
          -0.0022265193685673105,
          0.0008452617755227705,
          0.0026880323792226094,
          0.0008063720359924485,
          -0.0020206399672506228,
          -0.0019043872716243452,
          0.0006722842728983527,
          0.001966789531520043,
          0.0005335001383293653,
          -0.0011745822153944225,
          -0.0009312358266875265,
          0.00025370966480543257,
          0.0004685515952851485,
          0.00002905687857771753,
          0.00024479922140191695,
          0.0005756673405934666,
          -0.0003510054031024976,
          -0.0015637000280716432,
          -0.0006165354836011216,
          0.001966360338076748,
          0.0023104699100444767,
          -0.0010117966002223945,
          -0.003672533480293342,
          -0.0012513881693474508,
          0.0035630524701592914,
          0.003822769533686473,
          -0.0015492367255187168,
          -0.0052558747972738795,
          -0.001685113546340878,
          0.004534506739687112,
          0.004611105288393572,
          -0.001774362257718979,
          -0.005717811707958544,
          -0.0017403624128975155,
          0.004437320830868234,
          0.004262936777642288,
          -0.00154092540283535,
          -0.004636827260459451,
          -0.0013041980454925478,
          0.0030239703550146995,
          0.002582988102049984,
          -0.0007986969837897518,
          -0.0019224439241756533,
          -0.0003726710798802781,
          0.0003580628096567157,
          -0.00029383655735007496,
          0.0003723494413086549,
          0.002074740502889636,
          0.0009163714078889869,
          -0.0031294171172970534,
          -0.0038626703261753943,
          0.0017539662569619717,
          0.0065607821439103535,
          0.002292768008635991,
          -0.006670378127118354,
          -0.007299800619134207,
          0.003011427134895463,
          0.010399826955562866,
          0.0033923351713246183,
          -0.009278280949629392,
          -0.009597068093749639,
          0.0037541885692389063,
          0.012321973331362512,
          0.0038228886538298444,
          -0.00994187192599393,
          -0.009764180366382377,
          0.003617219614379531,
          0.011193341001153607,
          0.003253096625755736,
          -0.007854294634125954,
          -0.007062699553006988,
          0.0023468288696637265,
          0.006299635985635809,
          0.0014982705909831048,
          -0.002626314832684394,
          -0.0012085382314787388,
          -0.00012476896903733376,
          -0.002436307705231084,
          -0.001420797652300751,
          0.005568235819816512,
          0.007504109239772196,
          -0.003637901045885654,
          -0.014350521872091635,
          -0.005254348960020253,
          0.015955581900010295,
          0.018189677715486827,
          -0.007811945136132894,
          -0.028087464001375313,
          -0.00954725598935477,
          0.027255359388831165,
          0.029487616240890684,
          -0.012101191644639088,
          -0.0418034835396037,
          -0.013709284862439643,
          0.037886995082771165,
          0.03978861904284137,
          -0.015885951738070093,
          -0.0534871234132444,
          -0.017122823307940245,
          0.04625376991630138,
          0.04753087016680758,
          -0.018585880414284883,
          -0.061335120385046175,
          -0.01925794820304675,
          0.051045509276483735,
          0.05149536051215551,
          -0.01977341734683955,
          0.9359005003631228,
          -0.01977341734683955,
          0.05149536051215551,
          0.051045509276483735,
          -0.01925794820304675,
          -0.061335120385046175,
          -0.018585880414284883,
          0.04753087016680758,
          0.04625376991630138,
          -0.017122823307940245,
          -0.0534871234132444,
          -0.015885951738070093,
          0.03978861904284137,
          0.037886995082771165,
          -0.013709284862439643,
          -0.0418034835396037,
          -0.012101191644639088,
          0.029487616240890684,
          0.027255359388831165,
          -0.00954725598935477,
          -0.028087464001375313,
          -0.007811945136132894,
          0.018189677715486827,
          0.015955581900010295,
          -0.005254348960020253,
          -0.014350521872091635,
          -0.003637901045885654,
          0.007504109239772196,
          0.005568235819816512,
          -0.001420797652300751,
          -0.002436307705231084,
          -0.00012476896903733376,
          -0.0012085382314787388,
          -0.002626314832684394,
          0.0014982705909831048,
          0.006299635985635809,
          0.0023468288696637265,
          -0.007062699553006988,
          -0.007854294634125954,
          0.003253096625755736,
          0.011193341001153607,
          0.003617219614379531,
          -0.009764180366382377,
          -0.00994187192599393,
          0.0038228886538298444,
          0.012321973331362512,
          0.0037541885692389063,
          -0.009597068093749639,
          -0.009278280949629392,
          0.0033923351713246183,
          0.010399826955562866,
          0.003011427134895463,
          -0.007299800619134207,
          -0.006670378127118354,
          0.002292768008635991,
          0.0065607821439103535,
          0.0017539662569619717,
          -0.0038626703261753943,
          -0.0031294171172970534,
          0.0009163714078889869,
          0.002074740502889636,
          0.0003723494413086549,
          -0.00029383655735007496,
          0.0003580628096567157,
          -0.0003726710798802781,
          -0.0019224439241756533,
          -0.0007986969837897518,
          0.002582988102049984,
          0.0030239703550146995,
          -0.0013041980454925478,
          -0.004636827260459451,
          -0.00154092540283535,
          0.004262936777642288,
          0.004437320830868234,
          -0.0017403624128975155,
          -0.005717811707958544,
          -0.001774362257718979,
          0.004611105288393572,
          0.004534506739687112,
          -0.001685113546340878,
          -0.0052558747972738795,
          -0.0015492367255187168,
          0.003822769533686473,
          0.0035630524701592914,
          -0.0012513881693474508,
          -0.003672533480293342,
          -0.0010117966002223945,
          0.0023104699100444767,
          0.001966360338076748,
          -0.0006165354836011216,
          -0.0015637000280716432,
          -0.0003510054031024976,
          0.0005756673405934666,
          0.00024479922140191695,
          0.00002905687857771753,
          0.0004685515952851485,
          0.00025370966480543257,
          -0.0009312358266875265,
          -0.0011745822153944225,
          0.0005335001383293653,
          0.001966789531520043,
          0.0006722842728983527,
          -0.0019043872716243452,
          -0.0020206399672506228,
          0.0008063720359924485,
          0.0026880323792226094,
          0.0008452617755227705,
          -0.0022265193685673105,
          -0.002216448919796824,
          0.0008333473706077061,
          0.002630755983376361,
          0.0007850510826642776,
          -0.0019615233354878937,
          -0.0018535023971321522,
          0.0006601600806405553,
          0.0019740320630410287,
          0.0005555640816802097,
          -0.0012990767112802,
          -0.0011430667918108715,
          0.0003742278993398604,
          0.001006192947844117,
          0.00024941007312889344,
          -0.0004848391948224378,
          -0.00032683771909700716,
          0.00006522520619818877,
          0.000026864625956359102,
          -0.00004504895517187435,
          0.0002544678091375251,
          0.0003774187169437443,
          -0.0001868015242917632,
          -0.0007316298104571772,
          -0.0002591300823015407,
          0.0007663498483395823,
          0.0008350442496565084,
          -0.0003318534003213595,
          -0.0011399029233798868,
          -0.0003554634849200615,
          0.0009980609752710539,
          0.0010150372170075522,
          -0.00034548491139676997,
          -0.0011678147530398077,
          -0.0003070458298276321,
          0.0010213952937008289,
          0.001020242692458911,
          -0.0001700693475991525,
          -0.0007445411631120293,
          -0.000013328020676656547,
          0.0010293459744620391,
          0.0020169473933935368,
          -0.0008673275936080969,
          -0.0004842772922243099,
          -0.0002011960648318946
        }; 

        double[] DefaultFilteTaps = 
        {
          -0.000010853878607591139,
          -0.00003164665898925178,
          -0.00006612374724948723,
          -0.00010554269125355524,
          -0.00016235114212264043,
          -0.0002288114250975251,
          0.0016427962090986956,
          -0.00040285037497433994,
          -0.000489837595221149,
          -0.0005716903184748504,
          -0.0006406947543093791,
          -0.0007085868891879169,
          -0.0007624725522903758,
          -0.0007866875614603632,
          0.004918823231031935,
          -0.0007897585415894202,
          -0.0007715105944657751,
          -0.0007505165703146169,
          -0.0007211940900649553,
          -0.0006775764222349601,
          -0.0006358796566038849,
          -0.0005871471136096618,
          0.004136628650932332,
          -0.0005014318577810018,
          -0.00043737412318946403,
          -0.00036208248995373205,
          -0.00026414668564668384,
          -0.00016384852669498902,
          -0.00003975902087439709,
          0.00010204970182188228,
          -0.002004101868684611,
          0.00044632361991488184,
          0.0006308849075544677,
          0.000822160891318106,
          0.0010148576208754373,
          0.0012122833575979536,
          0.0014105177153815528,
          0.0015849731736446847,
          -0.012203385631171662,
          0.001906962239771316,
          0.0020363015296923173,
          0.002154441140907314,
          0.0022440939444478823,
          0.0023024085709206533,
          0.0023397728667423527,
          0.0023330375381926797,
          -0.01620234868647214,
          0.0022461985721849913,
          0.002133608048164985,
          0.0019905676260649472,
          0.00179531416850071,
          0.0015664807159633852,
          0.0012940267615532462,
          0.0009767920251117928,
          -0.004341616962438661,
          0.00023113626867871952,
          -0.0001945134506499218,
          -0.0006451011673450174,
          -0.0011240390507627422,
          -0.0016188129120310992,
          -0.002134419929843782,
          -0.0026431959325198037,
          0.022091844521307916,
          -0.003664560971427608,
          -0.004144528259845004,
          -0.004608796427763252,
          -0.005034658336600032,
          -0.0054142138745530135,
          -0.005753352584660674,
          -0.006013861355915222,
          0.04357538489477788,
          -0.006356488943574615,
          -0.006387702852067885,
          -0.006343823409166692,
          -0.006189188146230018,
          -0.005934728672634406,
          -0.005574204988552673,
          -0.005089448988676446,
          0.031497123768424666,
          -0.0037904685862117883,
          -0.0029538281324104462,
          -0.0020113374828929077,
          -0.0009436389876788349,
          0.00023074412778963568,
          0.0015203062691606923,
          0.0029040944046432073,
          -0.030701044778620776,
          0.005956796764931965,
          0.007597992555600013,
          0.009309333000845035,
          0.011074586565984822,
          0.012877340322453806,
          0.014722329884771786,
          0.01656205200807543,
          -0.1289414098602493,
          0.020264082190634733,
          0.02206062031208123,
          0.023831717193320983,
          0.025531584997352634,
          0.02715890010024457,
          0.028706448568267144,
          0.03013774435321029,
          -0.22029038609648618,
          0.032675061196491266,
          0.033729013689562215,
          0.034653526311766686,
          0.035410578346623256,
          0.03601177236687303,
          0.03644204446371548,
          0.03670278534550531,
          0.7424605908213128,
          0.03670278534550531,
          0.03644204446371548,
          0.03601177236687303,
          0.035410578346623256,
          0.034653526311766686,
          0.033729013689562215,
          0.032675061196491266,
          -0.22029038609648618,
          0.03013774435321029,
          0.028706448568267144,
          0.02715890010024457,
          0.025531584997352634,
          0.023831717193320983,
          0.02206062031208123,
          0.020264082190634733,
          -0.1289414098602493,
          0.01656205200807543,
          0.014722329884771786,
          0.012877340322453806,
          0.011074586565984822,
          0.009309333000845035,
          0.007597992555600013,
          0.005956796764931965,
          -0.030701044778620776,
          0.0029040944046432073,
          0.0015203062691606923,
          0.00023074412778963568,
          -0.0009436389876788349,
          -0.0020113374828929077,
          -0.0029538281324104462,
          -0.0037904685862117883,
          0.031497123768424666,
          -0.005089448988676446,
          -0.005574204988552673,
          -0.005934728672634406,
          -0.006189188146230018,
          -0.006343823409166692,
          -0.006387702852067885,
          -0.006356488943574615,
          0.04357538489477788,
          -0.006013861355915222,
          -0.005753352584660674,
          -0.0054142138745530135,
          -0.005034658336600032,
          -0.004608796427763252,
          -0.004144528259845004,
          -0.003664560971427608,
          0.022091844521307916,
          -0.0026431959325198037,
          -0.002134419929843782,
          -0.0016188129120310992,
          -0.0011240390507627422,
          -0.0006451011673450174,
          -0.0001945134506499218,
          0.00023113626867871952,
          -0.004341616962438661,
          0.0009767920251117928,
          0.0012940267615532462,
          0.0015664807159633852,
          0.00179531416850071,
          0.0019905676260649472,
          0.002133608048164985,
          0.0022461985721849913,
          -0.01620234868647214,
          0.0023330375381926797,
          0.0023397728667423527,
          0.0023024085709206533,
          0.0022440939444478823,
          0.002154441140907314,
          0.0020363015296923173,
          0.001906962239771316,
          -0.012203385631171662,
          0.0015849731736446847,
          0.0014105177153815528,
          0.0012122833575979536,
          0.0010148576208754373,
          0.000822160891318106,
          0.0006308849075544677,
          0.00044632361991488184,
          -0.002004101868684611,
          0.00010204970182188228,
          -0.00003975902087439709,
          -0.00016384852669498902,
          -0.00026414668564668384,
          -0.00036208248995373205,
          -0.00043737412318946403,
          -0.0005014318577810018,
          0.004136628650932332,
          -0.0005871471136096618,
          -0.0006358796566038849,
          -0.0006775764222349601,
          -0.0007211940900649553,
          -0.0007505165703146169,
          -0.0007715105944657751,
          -0.0007897585415894202,
          0.004918823231031935,
          -0.0007866875614603632,
          -0.0007624725522903758,
          -0.0007085868891879169,
          -0.0006406947543093791,
          -0.0005716903184748504,
          -0.000489837595221149,
          -0.00040285037497433994,
          0.0016427962090986956,
          -0.0002288114250975251,
          -0.00016235114212264043,
          -0.00010554269125355524,
          -0.00006612374724948723,
          -0.00003164665898925178,
          -0.000010853878607591139
        };

        public Filtr()
        {
            history = new double[DefaultFilteTaps.Length];
            filter_taps_cffs = DefaultFilteTaps;
        }

        public Filtr(int SAMPLEFILTER_TAP_NUM, ref double[] filter_k)
        {
            if (filter_k != null)
            {
                history = new double[SAMPLEFILTER_TAP_NUM];
                filter_taps_cffs = filter_k;
            }
        }

        public Filtr(int MODE)
        {
            if (MODE == FILTR_30_HZ)
            {
                history = new double[filter_taps_30_Hz.Length];
                filter_taps_cffs = filter_taps_30_Hz;
            }
            if (MODE == FILTR_50_HZ)
            {
                history = new double[filter_taps_50_Hz.Length];
                filter_taps_cffs = filter_taps_50_Hz;
            }
            if (MODE == FILTR_80_HZ)
            {
                history = new double[filter_taps_80_Hz.Length];
                filter_taps_cffs = filter_taps_80_Hz;
            }
            if (MODE == FILTR_100_150_HZ)
            {
                history = new double[filter_taps_100_150_HZ.Length];
                filter_taps_cffs = filter_taps_100_150_HZ;
            }
            if (MODE == FILTR_Over100HZ)
            {
                history = new double[filter_taps_100_150_HZ.Length];
                filter_taps_cffs = filter_taps_100_150_HZ;
            }

        }

        public double Calc(double input)
        {
            double acc = new double();

            if (history != null)
            {
                history[last_index++] = input;
                if (last_index == history.Length) last_index = 0;

                int index = last_index;

                for (int i = new int(); i < history.Length; i++)
                {
                    index = index != 0 ? index - 1 : history.Length - 1;
                    acc += history[index] * filter_taps_cffs[i];
                }

                return acc;
            }
            else
            {
                return input;
            }
        }
    }
}
